<!-- Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT License. -->
<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <!-- Office JavaScript API -->
    <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
</head>

<body>
    <p>This add-in will refresh the slides.</p>
    <button onclick="refresh()">Refresh slides!</button>
</body>

<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.8.0/xlsx.js" > </script>
<script src = "https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.8.0/jszip.js" > </script>

<script>
    const url = "https://vergfravikis-my.sharepoint.com/:w:/g/personal/gunnar_vergfravik_is/EftS3MFHwRZIs-FsImow1sEBQac4HCzcCRLH7gYkzG5jhw?e=hLiYI5";

    async function createFile() {
        let response = await fetch(url);
        let data = await response.blob();
        let metadata = {
        type: 'application / vnd.ms - excel'
    };
        let file = new File([data], "Links.xlsx", metadata);

        return file;
    }

    const file = await createFile();

    var ExcelToJSON = function() {

    this.parseExcel = function(file) {
        var reader = new FileReader();

    reader.onload = function(e) {
        var data = e.target.result;
        var workbook = XLSX.read(data, {
        type: 'binary'
    });

    workbook.SheetNames.forEach(function(sheetName) {
      // Here is your object
      var XL_row_object = XLSX.utils.sheet_to_row_object_array(workbook.Sheets[sheetName]);
      var json_object = JSON.stringify(XL_row_object);
      console.log(json_object);

    })

  };

  reader.onerror = function(ex) {
    console.log(ex);
  };

  reader.readAsBinaryString(file);
};
    };
</script>

<script>

    Office.onReady((info) => {
        // Check that we loaded into PowerPoint
        if (info.host === Office.HostType.PowerPoint) {
            document.getElementById("helloButton").onclick = refresh;
        }
    });

    async function refresh() {

    var links;
    var linksArray = new Array();
    var maxLinks = 6;
    
    
    // var img;
    // var imgArray = new Array();
    // var maxImages = 6;

    // for (let i = 1; i <= maxImages; i++) {
    //     img = new Image();
    //     img.onload = function() {imgArray.push(img)};
    //     img.onerror = function() {i = maxImages} 
    //     img.src = './JPGs/' + i + '.jpg';
    // }


    await PowerPoint.run(async(context) => {
    
    // const slide = context.presentation.slides.getItemAt(2);
    // const images = slide.images;

    // images.load("items/$none");
    // await context.sync();

    // images.items.forEach(function(image) {
    //     image.delete();
    // });
    // await context.sync();
    const shapes = context.presentation.slides.getItemAt(0).shapes;
    const textbox = shapes.addTextBox("TÃ³kst!", {
      left: 100,
      top: 300,
      height: 300,
      width: 450
    });
    textbox.name = "Textbox";

    return context.sync();
        });
    };

</script>

</html>